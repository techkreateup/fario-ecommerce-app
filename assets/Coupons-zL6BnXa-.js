const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-443OJVL2.js","assets/framer-ClpLoJbl.js","assets/vendor-CSLgDR2_.js","assets/icons-D8yHJv9q.js","assets/supabase-CDGuCRB-.js","assets/index-C9D46Yhe.css"])))=>i.map(i=>d[i]);
import{b as w,_ as u}from"./index-443OJVL2.js";import{j as e,A as k,m as b}from"./framer-ClpLoJbl.js";import{r as o}from"./vendor-CSLgDR2_.js";import{ac as C,e as E,ay as g,C as A,aQ as D,a7 as F}from"./icons-D8yHJv9q.js";import"./supabase-CDGuCRB-.js";const L=()=>{const[x,m]=o.useState([]),[y,h]=o.useState(!0),[f,p]=o.useState(!1),[t,n]=o.useState({discount_type:"percentage",is_active:!0,value:0,min_order_value:0,usage_limit:0}),c=w(),d=async()=>{try{h(!0);const{supabase:a}=await u(async()=>{const{supabase:l}=await import("./index-443OJVL2.js").then(i=>i.c);return{supabase:l}},__vite__mapDeps([0,1,2,3,4,5])),{data:s,error:r}=await a.from("coupons").select("*").order("created_at",{ascending:!1});if(r)throw r;m(s||[])}catch(a){console.error("Error fetching coupons:",a),m([])}finally{h(!1)}};o.useEffect(()=>{d()},[]);const j=async a=>{if(a.preventDefault(),!(!t.code||!t.value))try{const{supabase:s}=await u(async()=>{const{supabase:i}=await import("./index-443OJVL2.js").then(_=>_.c);return{supabase:i}},__vite__mapDeps([0,1,2,3,4,5])),r={code:t.code.toUpperCase(),discount_type:t.discount_type,value:Number(t.value),min_order_value:Number(t.min_order_value||0),usage_limit:Number(t.usage_limit||0),expires_at:t.expires_at||null,is_active:t.is_active,used_count:0},{error:l}=await s.from("coupons").upsert(r);if(l)throw l;c.success("Coupon created successfully"),p(!1),d(),n({discount_type:"percentage",is_active:!0,value:0})}catch(s){console.error(s),c.error("Failed to create coupon: "+s.message)}},v=async a=>{if(confirm("Are you sure you want to delete this coupon?"))try{const{supabase:s}=await u(async()=>{const{supabase:l}=await import("./index-443OJVL2.js").then(i=>i.c);return{supabase:l}},__vite__mapDeps([0,1,2,3,4,5])),{error:r}=await s.from("coupons").delete().eq("code",a);if(r)throw r;c.success("Coupon deleted"),d()}catch{c.error("Failed to delete coupon")}},N=async(a,s)=>{try{const{supabase:r}=await u(async()=>{const{supabase:l}=await import("./index-443OJVL2.js").then(i=>i.c);return{supabase:l}},__vite__mapDeps([0,1,2,3,4,5]));await r.from("coupons").update({is_active:!s}).eq("code",a),d()}catch{c.error("Failed to update status")}};return e.jsxs("div",{className:"space-y-8 pb-24 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"admin-h1",children:"Coupon Management"}),e.jsx("p",{className:"admin-subtitle",children:"Create and track discount codes."})]}),e.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-2 px-6 py-3 bg-fario-purple text-white rounded-xl font-bold shadow-lg hover:bg-fario-purple/90 transition-all active:scale-95",children:[e.jsx(C,{size:20})," New Coupon"]})]}),e.jsx("div",{className:"bg-white rounded-[2.5rem] shadow-sm border border-gray-100 overflow-hidden min-h-[400px]",children:y?e.jsx("div",{className:"flex items-center justify-center h-[400px]",children:e.jsx(E,{className:"w-8 h-8 animate-spin text-fario-purple"})}):x.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-[400px] text-gray-400",children:[e.jsx(g,{size:48,className:"mb-4 opacity-20"}),e.jsx("p",{className:"font-bold",children:"No coupons found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50/50 text-[10px] font-black uppercase tracking-[0.2em] text-gray-400 border-b border-gray-100",children:[e.jsx("th",{className:"px-8 py-6",children:"Code"}),e.jsx("th",{className:"px-6 py-6",children:"Discount"}),e.jsx("th",{className:"px-6 py-6",children:"Usage"}),e.jsx("th",{className:"px-6 py-6",children:"Status"}),e.jsx("th",{className:"px-8 py-6 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:x.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50/50 transition-colors group",children:[e.jsx("td",{className:"px-8 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 bg-fario-purple/10 text-fario-purple rounded-xl",children:e.jsx(g,{size:18})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-black text-slate-900",children:a.code}),e.jsxs("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:["Min: ₹",a.min_order_value]})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-bold text-slate-700",children:a.discount_type==="percentage"?`${a.value}% OFF`:`₹${a.value} OFF`})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"text-sm font-medium text-slate-600",children:[e.jsx("span",{className:"font-bold text-slate-900",children:a.used_count}),e.jsx("span",{className:"text-gray-400 mx-1",children:"/"}),e.jsx("span",{className:"text-gray-400",children:a.usage_limit===0?"∞":a.usage_limit})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("button",{onClick:()=>N(a.code,a.is_active),className:`px-3 py-1.5 rounded-lg text-[10px] font-black uppercase tracking-wider border flex items-center gap-1.5 transition-all ${a.is_active?"bg-emerald-50 text-emerald-600 border-emerald-100":"bg-gray-100 text-gray-400 border-gray-200"}`,children:[a.is_active?e.jsx(A,{size:12}):e.jsx(D,{size:12}),a.is_active?"Active":"Inactive"]})}),e.jsx("td",{className:"px-8 py-4 text-right",children:e.jsx("button",{onClick:()=>v(a.code),className:"p-2 text-gray-300 hover:text-rose-500 hover:bg-rose-50 rounded-lg transition-colors",children:e.jsx(F,{size:16})})})]},a.code))})]})})}),e.jsx(k,{children:f&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>p(!1),className:"absolute inset-0 bg-slate-900/40 backdrop-blur-sm"}),e.jsxs(b.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"bg-white rounded-[2rem] p-8 w-full max-w-md relative z-10 shadow-2xl",children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 mb-6",children:"Create New Coupon"}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-gray-400 block mb-2",children:"Code"}),e.jsx("input",{required:!0,type:"text",value:t.code||"",onChange:a=>n({...t,code:a.target.value.toUpperCase()}),className:"w-full bg-gray-50 border-2 border-transparent focus:border-fario-purple rounded-xl px-4 py-3 font-bold text-slate-900 outline-none transition-all placeholder:text-gray-300",placeholder:"SUMMER2026"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-gray-400 block mb-2",children:"Type"}),e.jsxs("select",{value:t.discount_type,onChange:a=>n({...t,discount_type:a.target.value}),className:"w-full bg-gray-50 border-none rounded-xl px-4 py-3 font-bold text-slate-700 outline-none",children:[e.jsx("option",{value:"percentage",children:"Percentage (%)"}),e.jsx("option",{value:"fixed",children:"Fixed Amount (₹)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-gray-400 block mb-2",children:"Value"}),e.jsx("input",{required:!0,type:"number",value:t.value||"",onChange:a=>n({...t,value:Number(a.target.value)}),className:"w-full bg-gray-50 border-none rounded-xl px-4 py-3 font-bold text-slate-900 outline-none",placeholder:"20"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-gray-400 block mb-2",children:"Min Order (₹)"}),e.jsx("input",{type:"number",value:t.min_order_value||"",onChange:a=>n({...t,min_order_value:Number(a.target.value)}),className:"w-full bg-gray-50 border-none rounded-xl px-4 py-3 font-bold text-slate-900 outline-none",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-black uppercase tracking-widest text-gray-400 block mb-2",children:"Limit"}),e.jsx("input",{type:"number",value:t.usage_limit||"",onChange:a=>n({...t,usage_limit:Number(a.target.value)}),className:"w-full bg-gray-50 border-none rounded-xl px-4 py-3 font-bold text-slate-900 outline-none",placeholder:"0 (Unlimited)"})]})]}),e.jsx("button",{type:"submit",className:"w-full py-4 bg-fario-purple text-white rounded-xl font-black uppercase tracking-widest text-xs mt-4 shadow-lg shadow-fario-purple/20 hover:bg-fario-purple/90 transition-all active:scale-[0.98]",children:"Create Coupon"})]})]})]})})]})};export{L as default};
