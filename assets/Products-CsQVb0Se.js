import{j as e,m as h,A as w}from"./framer-ClpLoJbl.js";import{r as l}from"./vendor-CSLgDR2_.js";import{s as u}from"./index-Bn3Kbo31.js";import{u as U}from"./useRealtimeAdmin-BMDEusAS.js";import{aB as F,ac as I,i as $,aC as B,a7 as v,aD as R,K as O,aE as k,C as K}from"./icons-BvlAoJhe.js";import"./supabase-CDGuCRB-.js";const W=()=>{const{logAction:C}=U(),[f,S]=l.useState([]),[o,y]=l.useState([]),[P,N]=l.useState(!0),[i,A]=l.useState(""),[d,z]=l.useState("All"),[a,n]=l.useState([]),[D,g]=l.useState(!1),[x,b]=l.useState(null),j=async()=>{N(!0);const{data:t,error:s}=await u.from("products").select("*").order("created_at",{ascending:!1});s?console.error("Error fetching products:",s):(S(t||[]),y(t||[])),N(!1)};l.useEffect(()=>{j();const t=u.channel("products-list").on("postgres_changes",{event:"*",schema:"public",table:"products"},j).subscribe();return()=>{u.removeChannel(t)}},[]),l.useEffect(()=>{let t=f;if(i){const s=i.toLowerCase();t=t.filter(c=>{var m;return c.name.toLowerCase().includes(s)||((m=c.description)==null?void 0:m.toLowerCase().includes(s))})}d!=="All"&&(t=t.filter(s=>s.category===d)),y(t)},[i,d,f]);const E=t=>{t.target.checked?n(o.map(s=>s.id)):n([])},Q=t=>{a.includes(t)?n(s=>s.filter(c=>c!==t)):n(s=>[...s,t])},T=async()=>{const{error:t}=await u.from("products").delete().in("id",a);t?b({msg:"Failed to delete products",type:"error"}):(b({msg:`Deleted ${a.length} products`,type:"success"}),await C("BULK_DELETE_PRODUCTS",{count:a.length,ids:a}),n([]),g(!1),j())},L=()=>{const t=["ID","Name","Price","Stock","Category","Created At"],s=o.map(r=>[r.id,r.name,r.price,r.stockQuantity,r.category,r.created_at]),c="data:text/csv;charset=utf-8,"+[t.join(","),...s.map(r=>r.join(","))].join(`
`),m=encodeURI(c),p=document.createElement("a");p.setAttribute("href",m),p.setAttribute("download","fario_products_export.csv"),document.body.appendChild(p),p.click()},_=["All",...Array.from(new Set(f.map(t=>t.category))).filter(Boolean)];return e.jsxs("div",{className:"p-8 space-y-8 animate-in fade-in duration-500 pb-24",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black text-slate-900 tracking-tight",children:"Product Inventory"}),e.jsx("p",{className:"text-slate-500 font-medium",children:"Manage catalogue, stock levels, and pricing."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:L,className:"px-4 py-2 bg-white border border-slate-200 rounded-xl text-xs font-bold text-slate-600 hover:bg-slate-50 transition-all flex items-center gap-2",children:[e.jsx(F,{size:16})," Export"]}),e.jsxs("button",{className:"px-6 py-2 bg-fario-purple text-white rounded-xl text-xs font-bold hover:bg-fario-purple/90 transition-all shadow-lg flex items-center gap-2",children:[e.jsx(I,{size:16})," Add Product"]})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-slate-200 shadow-sm flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"relative w-full md:w-96",children:[e.jsx($,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search products...",value:i,onChange:t=>A(t.target.value),className:"w-full pl-10 pr-4 py-2 bg-slate-50 border-none rounded-xl text-sm font-medium focus:ring-2 focus:ring-fario-purple/20"})]}),e.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto overflow-x-auto pb-2 md:pb-0",children:[e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-slate-50 rounded-xl min-w-max",children:[e.jsx(B,{size:16,className:"text-slate-400"}),e.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:"Category:"}),e.jsx("select",{value:d,onChange:t=>z(t.target.value),className:"bg-transparent border-none text-sm font-bold text-slate-900 focus:ring-0 cursor-pointer",children:_.map(t=>e.jsx("option",{value:t,children:t},t))})]}),a.length>0&&e.jsxs(h.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"flex items-center gap-3 bg-fario-purple/10 px-4 py-2 rounded-xl",children:[e.jsxs("span",{className:"text-xs font-bold text-fario-purple",children:[a.length," Selected"]}),e.jsx("div",{className:"h-4 w-px bg-fario-purple/20"}),e.jsx("button",{onClick:()=>g(!0),className:"text-rose-500 hover:text-rose-700 transition-colors",children:e.jsx(v,{size:16})})]})]})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-[2rem] shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left",children:e.jsx("input",{type:"checkbox",onChange:E,checked:a.length===o.length&&o.length>0,className:"rounded border-slate-300 text-fario-purple focus:ring-fario-purple"})}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-black text-slate-400 uppercase tracking-widest",children:"Product"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-black text-slate-400 uppercase tracking-widest",children:"Category"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-black text-slate-400 uppercase tracking-widest",children:"Price"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-black text-slate-400 uppercase tracking-widest",children:"Stock"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-black text-slate-400 uppercase tracking-widest",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-black text-slate-400 uppercase tracking-widest",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:o.map(t=>e.jsxs("tr",{className:"group hover:bg-slate-50/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"checkbox",checked:a.includes(t.id),onChange:()=>Q(t.id),className:"rounded border-slate-300 text-fario-purple focus:ring-fario-purple"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-slate-100 border border-slate-200 p-1",children:e.jsx("img",{src:t.image,alt:t.name,className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-slate-900",children:t.name}),e.jsxs("p",{className:"text-[10px] text-slate-400 font-mono",children:["ID: ",t.id.substring(0,8)]})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"px-2 py-1 rounded-lg bg-slate-100 text-xs font-bold text-slate-600 border border-slate-200",children:t.category||"Uncategorized"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("p",{className:"text-sm font-black text-slate-900",children:["â‚¹",t.price.toLocaleString()]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${t.stockQuantity<10?"bg-rose-500 animate-pulse":"bg-emerald-500"}`}),e.jsxs("span",{className:`text-sm font-bold ${t.stockQuantity<10?"text-rose-600":"text-slate-600"}`,children:[t.stockQuantity," Units"]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-lg text-[10px] font-black uppercase tracking-wide ${t.stockQuantity>0?"bg-emerald-50 text-emerald-600":"bg-rose-50 text-rose-600"}`,children:t.stockQuantity>0?"In Stock":"Out of Stock"})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{className:"p-2 hover:bg-white hover:shadow-sm rounded-lg text-slate-400 hover:text-fario-purple transition-all",children:e.jsx(R,{size:16})}),e.jsx("button",{className:"p-2 hover:bg-white hover:shadow-sm rounded-lg text-slate-400 hover:text-rose-500 transition-all",children:e.jsx(v,{size:16})})]})})]},t.id))})]})}),o.length===0&&!P&&e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(O,{size:48,className:"mx-auto text-slate-200 mb-4"}),e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"No products found"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Try adjusting your search or filters."})]})]}),e.jsx(w,{children:D&&e.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs(h.div,{initial:{scale:.95,y:20},animate:{scale:1,y:0},exit:{scale:.95,y:20},className:"bg-white rounded-[2rem] p-8 max-w-md w-full shadow-2xl",children:[e.jsx("div",{className:"w-12 h-12 bg-rose-100 rounded-full flex items-center justify-center text-rose-500 mb-4 mx-auto",children:e.jsx(k,{size:24})}),e.jsxs("h3",{className:"text-xl font-black text-center text-slate-900 mb-2",children:["Delete ",a.length," Products?"]}),e.jsx("p",{className:"text-center text-slate-500 text-sm mb-8",children:"This action cannot be undone. These products will be permanently removed from the inventory."}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:()=>g(!1),className:"flex-1 py-3 rounded-xl bg-slate-100 text-slate-700 font-bold hover:bg-slate-200 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:T,className:"flex-1 py-3 rounded-xl bg-rose-500 text-white font-bold hover:bg-rose-600 transition-colors shadow-lg shadow-rose-200",children:"Confirm Delete"})]})]})})}),e.jsx(w,{children:x&&e.jsxs(h.div,{initial:{opacity:0,y:20,x:"-50%"},animate:{opacity:1,y:0,x:"-50%"},exit:{opacity:0,y:20,x:"-50%"},className:`fixed bottom-8 left-1/2 z-[200] px-6 py-3 rounded-2xl shadow-2xl flex items-center gap-3 border ${x.type==="success"?"bg-slate-900 border-slate-800 text-white":"bg-rose-600 border-rose-500 text-white"}`,onAnimationComplete:()=>setTimeout(()=>b(null),3e3),children:[x.type==="success"?e.jsx(K,{size:18,className:"text-emerald-400"}):e.jsx(k,{size:18}),e.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:x.msg})]})})]})};export{W as default};
