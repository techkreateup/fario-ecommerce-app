import{j as e}from"./framer-ClpLoJbl.js";import{r as l}from"./vendor-CSLgDR2_.js";import{s as o}from"./index-DYlR4Og9.js";import"./icons-D8yHJv9q.js";import"./supabase-CDGuCRB-.js";function C(){const[d,p]=l.useState([]),[x,i]=l.useState(!0),[c,u]=l.useState(!1),[t,a]=l.useState({code:"",discounttype:"percentage",discountvalue:"",minordervalue:""}),n=async()=>{try{i(!0);const{data:s,error:r}=await o.from("coupons").select("*").order("createdat",{ascending:!1});r?(console.error("Error:",r),alert("Error loading coupons: "+r.message)):p(s||[])}catch(s){console.error("Catch error:",s)}finally{i(!1)}};l.useEffect(()=>{n()},[]);const m=async s=>{s.preventDefault();try{const{error:r}=await o.from("coupons").insert([{code:t.code.toUpperCase(),discounttype:t.discounttype,discountvalue:parseFloat(t.discountvalue),minordervalue:parseFloat(t.minordervalue)||0,isactive:!0,usedcount:0}]);if(r)throw r;alert("âœ… Coupon created!"),u(!1),a({code:"",discounttype:"percentage",discountvalue:"",minordervalue:""}),n()}catch(r){alert("Error: "+r.message)}},h=async(s,r)=>{try{await o.from("coupons").update({isactive:!r}).eq("id",s),n()}catch(v){alert("Error: "+v.message)}},j=async s=>{if(confirm("Delete?"))try{await o.from("coupons").delete().eq("id",s),n()}catch(r){alert("Error: "+r.message)}};return x?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"text-xl",children:"Loading coupons..."})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"ðŸŽŸï¸ Coupons"}),e.jsx("button",{onClick:()=>u(!c),className:"bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700",children:c?"Cancel":"+ Create Coupon"})]}),c&&e.jsxs("form",{onSubmit:m,className:"bg-white p-6 rounded shadow mb-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2",children:"Code *"}),e.jsx("input",{type:"text",value:t.code,onChange:s=>a({...t,code:s.target.value}),className:"w-full border rounded px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2",children:"Type"}),e.jsxs("select",{value:t.discounttype,onChange:s=>a({...t,discounttype:s.target.value}),className:"w-full border rounded px-3 py-2",children:[e.jsx("option",{value:"percentage",children:"Percentage"}),e.jsx("option",{value:"fixed",children:"Fixed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2",children:"Value *"}),e.jsx("input",{type:"number",value:t.discountvalue,onChange:s=>a({...t,discountvalue:s.target.value}),className:"w-full border rounded px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block mb-2",children:"Min Order"}),e.jsx("input",{type:"number",value:t.minordervalue,onChange:s=>a({...t,minordervalue:s.target.value}),className:"w-full border rounded px-3 py-2"})]})]}),e.jsx("button",{type:"submit",className:"mt-4 bg-green-600 text-white px-6 py-2 rounded",children:"Create"})]}),e.jsx("div",{className:"bg-white rounded shadow overflow-hidden",children:d.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No coupons yet"})}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:"Code"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Discount"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Min Order"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Used"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Actions"})]})}),e.jsx("tbody",{children:d.map(s=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"px-4 py-3 font-bold",children:s.code}),e.jsx("td",{className:"px-4 py-3",children:s.discounttype==="percentage"?`${s.discountvalue}%`:`â‚¹${s.discountvalue}`}),e.jsxs("td",{className:"px-4 py-3",children:["â‚¹",s.minordervalue]}),e.jsx("td",{className:"px-4 py-3",children:s.usedcount}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${s.isactive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.isactive?"Active":"Inactive"})}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("button",{onClick:()=>h(s.id,s.isactive),className:"text-blue-600 mr-3",children:s.isactive?"Deactivate":"Activate"}),e.jsx("button",{onClick:()=>j(s.id),className:"text-red-600",children:"Delete"})]})]},s.id))})]})})]})}export{C as default};
