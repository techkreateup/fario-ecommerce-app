import{j as e,m as x,A as p}from"./framer-ClpLoJbl.js";import{r as a}from"./vendor-CSLgDR2_.js";import{s as l}from"./index-Bn3Kbo31.js";import{u as N}from"./useRealtimeAdmin-BMDEusAS.js";import{ac as y,C as f,aI as C,ax as k,a7 as A,aE as S}from"./icons-BvlAoJhe.js";import"./supabase-CDGuCRB-.js";const P=()=>{const{logAction:c}=N(),[h,g]=a.useState([]),[T,u]=a.useState(!0),[b,d]=a.useState(!1),[s,i]=a.useState({code:"",discountType:"percentage",discountValue:0,startDate:new Date().toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0],isActive:!0}),[n,o]=a.useState(null),m=async()=>{u(!0);const{data:t,error:r}=await l.from("coupons").select("*").order("created_at",{ascending:!1});r||g(t||[]),u(!1)};a.useEffect(()=>{m();const t=l.channel("coupons").on("postgres_changes",{event:"*",schema:"public",table:"coupons"},m).subscribe();return()=>{l.removeChannel(t)}},[]);const j=async()=>{if(!s.code||!s.discountValue){o({msg:"Please fill in all required fields",type:"error"});return}const{error:t}=await l.from("coupons").insert([s]);t?o({msg:"Failed to create coupon",type:"error"}):(o({msg:"Coupon created successfully",type:"success"}),await c("CREATE_COUPON",{code:s.code}),d(!1),i({code:"",discountType:"percentage",discountValue:0,startDate:new Date().toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0],isActive:!0}))},v=async(t,r)=>{await l.from("coupons").update({isActive:!r}).eq("id",t),await c("TOGGLE_COUPON_STATUS",{id:t,newStatus:!r})},w=async t=>{confirm("Are you sure you want to delete this coupon?")&&(await l.from("coupons").delete().eq("id",t),await c("DELETE_COUPON",{id:t}))};return e.jsxs("div",{className:"p-8 space-y-8 animate-in fade-in duration-500 pb-24",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black text-slate-900 tracking-tight",children:"Coupons & Discounts"}),e.jsx("p",{className:"text-slate-500 font-medium",children:"Manage promotional codes and offers."})]}),e.jsxs("button",{onClick:()=>d(!0),className:"px-6 py-2 bg-fario-purple text-white rounded-xl text-xs font-bold hover:bg-fario-purple/90 transition-all shadow-lg flex items-center gap-2",children:[e.jsx(y,{size:16})," Create Coupon"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(t=>e.jsxs(x.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white p-6 rounded-[2rem] border border-slate-100 shadow-sm relative overflow-hidden group hover:shadow-md transition-all",children:[e.jsxs("div",{className:`absolute top-0 right-0 p-4 ${t.isActive?"text-emerald-500":"text-slate-300"}`,children:[e.jsx(f,{size:20,className:t.isActive?"":"hidden"}),e.jsx(C,{size:20,className:t.isActive?"hidden":""})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-fario-purple/10 flex items-center justify-center text-fario-purple",children:e.jsx(k,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-black text-slate-900 tracking-tight",children:t.code}),e.jsx("p",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide",children:t.discountType==="percentage"?`${t.discountValue}% Off`:`â‚¹${t.discountValue} Off`})]})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"Usage"}),e.jsxs("span",{className:"font-bold text-slate-900",children:[t.usedCount," times"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"Expires"}),e.jsx("span",{className:"font-bold text-slate-900",children:new Date(t.endDate).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>v(t.id,t.isActive),className:`flex-1 py-2 rounded-xl text-xs font-bold uppercase tracking-wider transition-colors ${t.isActive?"bg-slate-100 text-slate-600 hover:bg-slate-200":"bg-emerald-50 text-emerald-600 hover:bg-emerald-100"}`,children:t.isActive?"Deactivate":"Activate"}),e.jsx("button",{onClick:()=>w(t.id),className:"p-2 rounded-xl bg-rose-50 text-rose-500 hover:bg-rose-100 transition-colors",children:e.jsx(A,{size:16})})]})]},t.id))}),e.jsx(p,{children:b&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs(x.div,{initial:{scale:.95,y:20},animate:{scale:1,y:0},exit:{scale:.95,y:20},className:"bg-white rounded-[2rem] p-8 max-w-md w-full shadow-2xl",children:[e.jsx("h2",{className:"text-xl font-black text-slate-900 mb-6",children:"Create New Coupon"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide mb-1 block",children:"Code"}),e.jsx("input",{type:"text",value:s.code,onChange:t=>i({...s,code:t.target.value.toUpperCase()}),className:"w-full bg-slate-500 border-none rounded-xl font-mono font-bold text-slate-900 uppercase focus:ring-2 focus:ring-fario-purple/20 bg-slate-50",placeholder:"SUMMER2025"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide mb-1 block",children:"Type"}),e.jsxs("select",{value:s.discountType,onChange:t=>i({...s,discountType:t.target.value}),className:"w-full bg-slate-50 border-none rounded-xl text-sm font-bold text-slate-900",children:[e.jsx("option",{value:"percentage",children:"Percentage"}),e.jsx("option",{value:"fixed",children:"Fixed Amount"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide mb-1 block",children:"Value"}),e.jsx("input",{type:"number",value:s.discountValue,onChange:t=>i({...s,discountValue:Number(t.target.value)}),className:"w-full bg-slate-50 border-none rounded-xl text-sm font-bold text-slate-900"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wide mb-1 block",children:"Valid Until"}),e.jsx("input",{type:"date",value:s.endDate,onChange:t=>i({...s,endDate:t.target.value}),className:"w-full bg-slate-50 border-none rounded-xl text-sm font-bold text-slate-900"})]})]}),e.jsxs("div",{className:"flex gap-4 mt-8",children:[e.jsx("button",{onClick:()=>d(!1),className:"flex-1 py-3 rounded-xl bg-slate-100 text-slate-600 font-bold hover:bg-slate-200",children:"Cancel"}),e.jsx("button",{onClick:j,className:"flex-1 py-3 rounded-xl bg-fario-purple text-white font-bold hover:bg-fario-purple/90 shadow-lg shadow-fario-purple/20",children:"Create Coupon"})]})]})})}),e.jsx(p,{children:n&&e.jsxs(x.div,{initial:{opacity:0,y:20,x:"-50%"},animate:{opacity:1,y:0,x:"-50%"},exit:{opacity:0,y:20,x:"-50%"},className:`fixed bottom-8 left-1/2 z-[200] px-6 py-3 rounded-2xl shadow-2xl flex items-center gap-3 border ${n.type==="success"?"bg-slate-900 border-slate-800 text-white":"bg-rose-600 border-rose-500 text-white"}`,onAnimationComplete:()=>setTimeout(()=>o(null),3e3),children:[n.type==="success"?e.jsx(f,{size:18,className:"text-emerald-400"}):e.jsx(S,{size:18}),e.jsx("span",{className:"text-xs font-black uppercase tracking-widest",children:n.msg})]})})]})};export{P as default};
