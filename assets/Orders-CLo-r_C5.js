import{j as e}from"./framer-ClpLoJbl.js";import{r as l}from"./vendor-CSLgDR2_.js";import{s as i}from"./index-Bn3Kbo31.js";import{u as w}from"./useRealtimeAdmin-BMDEusAS.js";import{i as v,W as y,h as k}from"./icons-BvlAoJhe.js";import"./supabase-CDGuCRB-.js";const E=()=>{const{logAction:u}=w(),[o,h]=l.useState([]),[x,m]=l.useState([]),[f,p]=l.useState(!0),[r,g]=l.useState("All"),[n,b]=l.useState(""),d=async()=>{p(!0);const{data:t,error:s}=await i.from("orders").select("*").order("created_at",{ascending:!1});s?console.error("Error fetching orders:",s):(h(t||[]),m(t||[])),p(!1)};l.useEffect(()=>{d();const t=i.channel("orders-list").on("postgres_changes",{event:"*",schema:"public",table:"orders"},d).subscribe();return()=>{i.removeChannel(t)}},[]),l.useEffect(()=>{let t=o;if(r!=="All"&&(t=t.filter(s=>s.status===r)),n){const s=n.toLowerCase();t=t.filter(a=>{var c;return a.id.toLowerCase().includes(s)||((c=a.user_email)==null?void 0:c.toLowerCase().includes(s))})}m(t)},[r,n,o]);const j=async(t,s)=>{const{error:a}=await i.from("orders").update({status:s}).eq("id",t);a||(await u("UPDATE_ORDER_STATUS",{orderId:t,status:s}),d())},N=t=>{switch(t){case"Completed":return"bg-emerald-100 text-emerald-700 border-emerald-200";case"Processing":return"bg-blue-100 text-blue-700 border-blue-200";case"Pending":return"bg-amber-100 text-amber-700 border-amber-200";case"Cancelled":return"bg-rose-100 text-rose-700 border-rose-200";default:return"bg-slate-100 text-slate-700 border-slate-200"}};return e.jsxs("div",{className:"p-8 space-y-8 animate-in fade-in duration-500 pb-24",children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-black text-slate-900 tracking-tight",children:"Order Management"}),e.jsx("p",{className:"text-slate-500 font-medium",children:"Track and process customer orders."})]})}),e.jsxs("div",{className:"bg-white p-4 rounded-2xl border border-slate-200 shadow-sm flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"relative w-full md:w-96",children:[e.jsx(v,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:18}),e.jsx("input",{type:"text",placeholder:"Search order ID or email...",value:n,onChange:t=>b(t.target.value),className:"w-full pl-10 pr-4 py-2 bg-slate-50 border-none rounded-xl text-sm font-medium focus:ring-2 focus:ring-fario-purple/20"})]}),e.jsx("div",{className:"flex items-center gap-2 overflow-x-auto w-full md:w-auto",children:["All","Pending","Processing","Completed","Cancelled"].map(t=>e.jsx("button",{onClick:()=>g(t),className:`px-4 py-2 rounded-xl text-xs font-bold transition-all whitespace-nowrap ${r===t?"bg-slate-900 text-white shadow-lg":"bg-slate-50 text-slate-500 hover:bg-slate-100"}`,children:t},t))})]}),e.jsxs("div",{className:"bg-white border border-slate-200 rounded-[2rem] shadow-sm overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 border-b border-slate-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-black text-slate-400 uppercase tracking-widest",children:"Order ID"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-black text-slate-400 uppercase tracking-widest",children:"Customer"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-black text-slate-400 uppercase tracking-widest",children:"Date"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-black text-slate-400 uppercase tracking-widest",children:"Total"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-black text-slate-400 uppercase tracking-widest",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-black text-slate-400 uppercase tracking-widest",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:x.map(t=>{var s,a;return e.jsxs("tr",{className:"group hover:bg-slate-50/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("p",{className:"text-sm font-bold text-slate-900",children:["#",t.id.substring(0,8)]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center text-xs font-bold text-slate-500",children:(s=t.user_email)==null?void 0:s[0].toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-slate-900",children:((a=t.shipping_address)==null?void 0:a.fullName)||"Guest"}),e.jsx("p",{className:"text-[10px] text-slate-400",children:t.user_email})]})]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("p",{className:"text-sm font-medium text-slate-600",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("p",{className:"text-[10px] text-slate-400",children:new Date(t.created_at).toLocaleTimeString()})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("p",{className:"text-sm font-black text-slate-900",children:["â‚¹",t.total.toLocaleString()]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded-lg text-[10px] font-black uppercase tracking-wide border ${N(t.status)}`,children:t.status})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsxs("select",{value:t.status,onChange:c=>j(t.id,c.target.value),className:"text-xs border-slate-200 rounded-lg py-1 px-2 focus:ring-fario-purple",children:[e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Processing",children:"Processing"}),e.jsx("option",{value:"Completed",children:"Completed"}),e.jsx("option",{value:"Cancelled",children:"Cancelled"})]}),e.jsx("button",{className:"p-2 hover:bg-white hover:shadow-sm rounded-lg text-slate-400 hover:text-fario-purple transition-all",children:e.jsx(y,{size:16})})]})})]},t.id)})})]})}),x.length===0&&!f&&e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(k,{size:48,className:"mx-auto text-slate-200 mb-4"}),e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:"No orders found"}),e.jsx("p",{className:"text-slate-500 text-sm",children:"Waiting for new orders to arrive."})]})]})]})};export{E as default};
