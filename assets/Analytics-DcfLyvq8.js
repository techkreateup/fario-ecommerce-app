const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CSh6C4Ty.js","assets/index-BVZu7NBY.css"])))=>i.map(i=>d[i]);
import{y as w,f as $,r as l,j as e,i as U,S as M,A as I,U as Q,l as q,m as H,P as F,_ as G}from"./index-CSh6C4Ty.js";import{D as V}from"./dollar-sign-NBSp-A98.js";import{U as B}from"./users-C3W2aTJ1.js";import{D as J,T as K}from"./trending-up-DauDyY2l.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],X=w("arrow-down-right",W);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Z=w("calendar",Y),re=()=>{var y;const{products:h}=$(),[n,k]=l.useState([]),[j,S]=l.useState(!0),[f,v]=l.useState(!1),[d,_]=l.useState({total_revenue:0,total_orders:0,total_customers:0,revenue_trend:0}),[b,D]=l.useState([]),[C,E]=l.useState([]),[u,L]=l.useState([]);l.useEffect(()=>{(async()=>{try{const{supabase:r}=await G(async()=>{const{supabase:c}=await import("./index-CSh6C4Ty.js").then(p=>p.ae);return{supabase:c}},__vite__mapDeps([0,1])),{data:x,error:o}=await r.from("orders").select("*").order("created_at",{ascending:!1});if(o)throw o;k(x||[])}catch(r){console.error("Failed to fetch analytics data",r)}})()},[]),l.useEffect(()=>{(async()=>{if(!(n.length===0&&j))try{const r=n.reduce((s,a)=>s+(a.status!=="Cancelled"?a.total:0),0),x=n.length,o=new Set(n.map(s=>s.useremail)).size,c={},p=Array.from({length:7},(s,a)=>{const i=new Date;return i.setDate(i.getDate()-a),i.toISOString().split("T")[0]}).reverse();n.forEach(s=>{const a=s.createdat?s.createdat.split("T")[0]:s.date||"";p.includes(a)&&(c[a]=(c[a]||0)+(s.status!=="Cancelled"?s.total:0))});const z=p.map(s=>({date:s,revenue:c[s]||0})),m={};n.forEach(s=>{s.status!=="Cancelled"&&s.items.forEach(a=>{m[a.id]||(m[a.id]={name:a.name,sold:0,revenue:0}),m[a.id].sold+=a.quantity,m[a.id].revenue+=a.price*a.quantity})});const R=Object.values(m).sort((s,a)=>a.revenue-s.revenue).slice(0,5).map(s=>({...s,total_sold:s.sold})),g={};n.forEach(s=>{s.status!=="Cancelled"&&s.items.forEach(a=>{const i=h.find(T=>T.id===a.id),N=(i==null?void 0:i.category)||"Uncategorized";g[N]=(g[N]||0)+a.price*a.quantity})});const O=Object.entries(g).map(([s,a])=>({category:s,revenue:a})).sort((s,a)=>a.revenue-s.revenue);_({total_revenue:r,total_orders:x,total_customers:o,revenue_trend:12.5}),D(z),E(R),L(O)}catch(r){console.error("Analytics calc error:",r)}finally{S(!1)}})()},[n,h]);const A=()=>{v(!0),setTimeout(()=>v(!1),2e3)};if(j)return e.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[60vh] space-y-4",children:[e.jsx(U,{className:"w-10 h-10 text-fario-purple animate-spin"}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-slate-400",children:"Synchronizing Data Node..."})]});const P=[{label:"Revenue",value:`₹${d.total_revenue.toLocaleString()}`,change:`${d.revenue_trend>0?"+":""}${d.revenue_trend.toFixed(1)}%`,trend:d.revenue_trend>=0?"up":"down",icon:V,color:"text-fario-purple"},{label:"Total Orders",value:d.total_orders.toLocaleString(),change:"+12.5%",trend:"up",icon:M,color:"text-emerald-500"},{label:"Active Users",value:d.total_customers.toLocaleString(),change:"+8.2%",trend:"up",icon:B,color:"text-sky-500"},{label:"Conversion",value:"3.4%",change:"-0.3%",trend:"down",icon:I,color:"text-amber-500"}];return e.jsxs("div",{className:"space-y-8 pb-20 animate-slide-up",children:[e.jsxs("header",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"admin-h1",children:"Business Insights"}),e.jsx("p",{className:"admin-subtitle",children:"Comprehensive performance metrics and market trends."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2.5 bg-white border border-slate-200 rounded-xl text-xs font-bold text-slate-600 hover:bg-slate-50 transition-colors",children:[e.jsx(Z,{size:16})," Last 30 Days"]}),e.jsxs("button",{onClick:A,className:"flex items-center gap-2 px-4 py-2.5 bg-slate-900 text-white rounded-xl text-xs font-bold hover:bg-fario-purple transition-all shadow-md",children:[f?e.jsx(Q,{size:16,className:"animate-spin"}):e.jsx(J,{size:16}),f?"Exporting...":"Download Report"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:P.map((t,r)=>e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:`p-3 rounded-xl bg-slate-50 ${t.color}`,children:e.jsx(t.icon,{size:20})}),e.jsxs("div",{className:`flex items-center gap-0.5 text-[10px] font-bold px-2 py-1 rounded-full ${t.trend==="up"?"text-emerald-600 bg-emerald-50":"text-rose-600 bg-rose-50"}`,children:[t.trend==="up"?e.jsx(q,{size:12}):e.jsx(X,{size:12}),t.change]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400 mb-1",children:t.label}),e.jsx("h4",{className:"text-2xl font-black text-slate-900 tracking-tight",children:t.value})]})]},t.label))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsxs("div",{className:"lg:col-span-8 admin-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-slate-900",children:"Revenue Performance"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Daily gross revenue distribution"})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-fario-purple"}),e.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase",children:"Gross"})]})})]}),e.jsx("div",{className:"h-[300px] flex items-end gap-2 md:gap-4 px-2",children:b.map((t,r)=>{const x=Math.max(...b.map(c=>c.revenue))||1,o=t.revenue/x*100;return e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-end h-full group relative",children:[e.jsx("div",{className:"w-full bg-slate-50 rounded-t-lg group-hover:bg-fario-purple/20 transition-all",style:{height:`${Math.max(10,o)}%`},children:e.jsxs("div",{className:"absolute -top-10 left-1/2 -translate-x-1/2 bg-slate-900 text-white text-[9px] font-black px-2.5 py-1.5 rounded-lg opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap z-30 shadow-xl pointer-events-none",children:["₹",Number(t.revenue).toLocaleString()]})}),e.jsx("span",{className:"text-[8px] font-black text-slate-300 mt-3 rotate-45 origin-left md:rotate-0",children:new Date(t.date).toLocaleDateString([],{month:"short",day:"numeric"})})]},r)})})]}),e.jsxs("div",{className:"lg:col-span-4 admin-card",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-slate-900",children:"Market Share"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Sales distribution by category"})]}),e.jsx("div",{className:"space-y-5",children:u.length>0?u.map((t,r)=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center text-[10px] font-black uppercase tracking-widest",children:[e.jsx("span",{className:"text-slate-600",children:t.category}),e.jsxs("span",{className:"text-slate-900",children:["₹",Number(t.revenue).toLocaleString()]})]}),e.jsx("div",{className:"h-2 bg-slate-50 rounded-full overflow-hidden",children:e.jsx(H.div,{initial:{width:0},animate:{width:`${t.revenue/u[0].revenue*100}%`},className:"h-full bg-fario-purple rounded-full"})})]},r)):e.jsx("div",{className:"text-center py-10",children:e.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-300 italic",children:"No Data Available"})})}),e.jsx("div",{className:"mt-8 pt-6 border-t border-slate-50",children:e.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl",children:[e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1",children:"Top Category"}),e.jsx("p",{className:"text-sm font-bold text-slate-900 italic",children:((y=u[0])==null?void 0:y.category)||"N/A"})]})})]})]}),e.jsxs("div",{className:"admin-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-slate-900",children:"Performance Leaderboard"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Highest grossing inventory units"})]}),e.jsx("div",{className:"p-2 bg-slate-50 rounded-lg text-slate-400",children:e.jsx(K,{size:18})})]}),e.jsx("div",{className:"admin-table-container",children:e.jsxs("table",{className:"admin-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product Entity"}),e.jsx("th",{children:"Units Deployed"}),e.jsx("th",{children:"Gross Revenue"}),e.jsx("th",{children:"Performance Status"})]})}),e.jsx("tbody",{children:C.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-8 h-8 rounded bg-slate-50 flex items-center justify-center font-black text-[10px] text-fario-purple italic border border-slate-100",children:["#",r+1]}),e.jsx("span",{className:"font-bold text-slate-900",children:t.name})]})}),e.jsxs("td",{className:"font-medium text-slate-500",children:[t.total_sold," units"]}),e.jsxs("td",{className:"font-black text-slate-900 italic",children:["₹",Number(t.revenue).toLocaleString()]}),e.jsx("td",{children:e.jsx("span",{className:"px-2.5 py-1 rounded-lg bg-emerald-50 text-emerald-600 text-[9px] font-black uppercase tracking-widest border border-emerald-100",children:"High Velocity"})})]},t.product_id||r))})]})})]}),e.jsxs("div",{className:"admin-card mt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-black uppercase tracking-widest text-slate-900",children:"Inventory Health"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Critical stock alerts"})]}),e.jsx("div",{className:"p-2 bg-slate-50 rounded-lg text-slate-400",children:e.jsx(F,{size:18})})]}),e.jsx("div",{className:"admin-table-container",children:e.jsxs("table",{className:"admin-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Product"}),e.jsx("th",{children:"Current Stock"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:h.filter(t=>(t.stockQuantity||0)<10).length>0?h.filter(t=>(t.stockQuantity||0)<10).map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-bold text-slate-900",children:t.name}),e.jsxs("td",{className:"font-medium text-slate-500",children:[t.stockQuantity||0," units"]}),e.jsx("td",{children:e.jsx("span",{className:`px-2.5 py-1 rounded-lg text-[9px] font-black uppercase tracking-widest border ${(t.stockQuantity||0)===0?"bg-red-50 text-red-600 border-red-100":"bg-amber-50 text-amber-600 border-amber-100"}`,children:(t.stockQuantity||0)===0?"Out of Stock":"Low Stock"})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"text-center py-4 text-slate-400 text-xs italic",children:"All systems operational. Inventory levels healthy."})})})]})})]})]})};export{re as default};
