import{j as r}from"./framer-Bjzrnjch.js";import{r as d}from"./vendor-CSLgDR2_.js";import{s as i}from"./index-DOR6h7BV.js";import"./icons-DLsciDlU.js";import"./supabase-CDGuCRB-.js";function v(){const[n,u]=d.useState([]),[c,l]=d.useState(!1),s=e=>{u(o=>[`[${new Date().toLocaleTimeString()}] ${e}`,...o])},m=async()=>{s("ðŸ•µï¸ Checking Auth...");const{data:{session:e},error:o}=await i.auth.getSession();if(o)s(`âŒ Auth Error: ${o.message}`);else if(e){s(`âœ… Logged in as: ${e.user.email}`),s(`ðŸ†” User ID: ${e.user.id}`);const{data:t}=await i.from("profiles").select("role").eq("id",e.user.id).single();s(`bust: Profile Role: ${(t==null?void 0:t.role)||"null"}`)}else s("âš ï¸ No active session")},g=async()=>{l(!0),s("ðŸš€ Fetching coupons (with 5s timeout)...");try{const e=new Promise((p,h)=>setTimeout(()=>h(new Error("TIMEOUT after 5 seconds")),5e3)),o=i.from("coupons").select("*"),{data:t,error:a}=await Promise.race([o,e]);a?(s(`âŒ Supabase Error: ${a.message}`),console.error(a)):(s(`âœ… Success! Found ${t==null?void 0:t.length} coupons.`),s(`ðŸ“„ Data: ${JSON.stringify(t).slice(0,100)}...`))}catch(e){s(`ðŸ”¥ CRITICAL FAILURE: ${e.message}`)}finally{l(!1)}};return r.jsxs("div",{className:"p-8 font-sans max-w-4xl mx-auto",children:[r.jsx("h1",{className:"text-2xl font-bold mb-6",children:"ðŸ› ï¸ Advanced Coupons Diagnostics"}),r.jsxs("div",{className:"flex gap-4 mb-6",children:[r.jsx("button",{onClick:m,className:"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700",children:"1. Check Auth & Role"}),r.jsx("button",{onClick:g,disabled:c,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 disabled:opacity-50",children:c?"Fetching...":"2. Test Fetch (5s Timeout)"})]}),r.jsx("div",{className:"bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-sm min-h-[300px] overflow-auto border border-gray-700 shadow-inner",children:n.length===0?r.jsx("div",{className:"text-gray-500 italic",children:"Ready for diagnostics... Click buttons above."}):n.map((e,o)=>r.jsx("div",{className:"mb-1 border-b border-gray-800 pb-1 last:border-0",children:e},o))})]})}export{v as default};
